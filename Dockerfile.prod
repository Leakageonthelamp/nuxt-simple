FROM node:10.17.0-alpine
ENV APP_DIR /app/
WORKDIR ${APP_DIR}

COPY . ./
RUN yarn install

ARG API_HOST
ARG API_PORT
ARG API_PREFIX
ARG NODE_ENV
ARG API_BASE_URL

ENV API_HOST ${API_HOST:-127.0.0.1}
ENV API_PORT ${API_PORT:-3030}
ENV API_PREFIX ${API_PREFIX:-/webhook}
ENV NODE_ENV ${NODE_ENV:-production}
ENV API_BASE_URL ${API_BASE_URL:-https://api.globish.co.th/webhook}

RUN yarn build

ENV NUXT_HOST 0.0.0.0
ENV NUXT_PORT 3030
EXPOSE 3030
CMD ["yarn", "start"]
